// Copyright Â© 2017-2018 Trust.
//
// This file is part of Trust. The full Trust copyright notice, including
// terms governing use, modification, and redistribution, is contained in the
// file LICENSE at the root of the source code distribution tree.

import Foundation

public class <%= entity.name %> {
<%- entity.static_properties.each do |property| -%>
    public static var <%= swift_name(property.name) %>: <%= swift_type(property.return_type) %> {
        <%- if property.return_type.is_class || property.return_type.is_struct -%>
        return <%= swift_type(property.return_type) %>(rawValue: TW<%= entity.name %><%= property.name %>())
        <%- else -%>
        return TW<%= entity.name %><%= property.name %>()
        <%- end -%>
    }

<%- end -%>
<%- entity.static_methods.each do |method| -%>
    <%- next if method.name.start_with?('Create') || method.name.start_with?('Init') %>
    <%- if should_return_data(method) -%>
<%= render('swift_data_returning_static_method.erb', { method: method }) %>
    <%- next end -%>
    public static func <%= swift_name(method.name) %>(<%= swift_parameters(method.parameters) %>) -> <%= swift_type(method.return_type) %> {
    <%- inout_data = method.parameters.detect { |e| e.type.name == :data && e.type.is_inout } -%>
    <%- unless inout_data.nil? -%>
        data.withUnsafeMutableBytes { ptr in
            <%- if method.return_type.is_class || method.return_type.is_struct -%>
            return <%= swift_type(method.return_type) %>(rawValue: TW<%= entity.name %><%= method.name %>(<%= swift_arguments(method.parameters) %>))
            <%- else -%>
            return TW<%= entity.name %><%= method.name %>(<%= swift_arguments(method.parameters) %>)
            <%- end -%>
        }
    <%- else -%>
        <%- if method.return_type.is_class || method.return_type.is_struct -%>
        return <%= swift_type(method.return_type) %>(rawValue: TW<%= entity.name %><%= method.name %>(<%= swift_arguments(method.parameters) %>))
        <%- else -%>
        return TW<%= entity.name %><%= method.name %>(<%= swift_arguments(method.parameters) %>)
        <%- end -%>
    <%- end -%>
    }

<%- end -%>

<%- if entity.is_struct -%>
<%= render('swift_struct_properties.erb') -%>
<%- else -%>
<%= render('swift_class_properties.erb') -%>
<%- end -%>
<%- entity.methods.each do |method| -%>
    <%- next if method.name == "Delete" %>
    <%- if should_return_data(method) -%>
<%= render('swift_data_returning_method.erb', { method: method }) %>
    <%- next -%>
    <%- elsif method.parameters.detect { |e| e.type.name == :data && e.type.is_inout } -%>
<%= render('swift_inout_data_method.erb', { method: method }) %>
    <%- next -%>
    <%- end -%>
    public func <%= swift_name(method.name) %>(<%= swift_parameters(method.parameters.drop(1)) %>) -> <%= swift_type(method.return_type) %> {
        <%- if method.return_type.is_class || method.return_type.is_struct -%>
        return <%= render('swift_entity_construct.erb', { method: method }) -%>
        <%- else -%>
        return <%= render('swift_method_Call.erb', { method: method }) -%>
        <%- end -%>
    }
<%- end -%>
}
